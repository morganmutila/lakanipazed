<style>
header .opts_head_acc > .btn, header .head_user .opts_account > .btn, header .head_user .notis > .btn, header .chaticon > .btn {background-color: #080808;box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);}
.sfy_plylist_hdr:before {background-image: url({{t_thumbnail}});}
</style>
<div class="ma_page_content sfy_pc_padd">
    <div class="ma_pc_inner">
		<button class="btn btn-mat btn-go-back" onclick="window.history.back();"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg></button>
		<div class="sfy_plylist_hdr sfy_song_hdr" id="sfy_hdr_rgb">
			<div class="valign sfy_plist_innr">
				<div class="sfy_plist_art">
					<img src="{{t_thumbnail}}" id="sfy_song_thmb" data-adaptive-background="1">
					<ul class="valign ss_stats list-unstyled mb-0">
						<li><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24"><path fill="currentColor" d="M13.12 2.06L7.58 7.6c-.37.37-.58.88-.58 1.41V19c0 1.1.9 2 2 2h9c.8 0 1.52-.48 1.84-1.21l3.26-7.61C23.94 10.2 22.49 8 20.34 8h-5.65l.95-4.58c.1-.5-.05-1.01-.41-1.37-.59-.58-1.53-.58-2.11.01zM3 21c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2s-2 .9-2 2v8c0 1.1.9 2 2 2z"></path></svg> <span id="track_likes_count" data-count="{{COUNT_LIKES}}">{{COUNT_LIKES}}</span></li>
						<li><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24"><path fill="currentColor" d="M10.88 21.94l5.53-5.54c.37-.37.58-.88.58-1.41V5c0-1.1-.9-2-2-2H6c-.8 0-1.52.48-1.83 1.21L.91 11.82C.06 13.8 1.51 16 3.66 16h5.65l-.95 4.58c-.1.5.05 1.01.41 1.37.59.58 1.53.58 2.11-.01zM21 3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2s2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg> <span id="track_dislikes_count" data-count="{{COUNT_DISLIKES}}">{{COUNT_DISLIKES}}</span></li>
						<li class="ss_track_info_innr_share_ico"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24"><path fill="currentColor" d="M10 3v2H5v14h14v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h6zm7.707 4.707L12 13.414 10.586 12l5.707-5.707L13 3h8v8l-3.293-3.293z"></path></svg> {{t_shares}}</li>
						<li><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24"><path fill="currentColor" d="M13.35 20.13c-.76.69-1.93.69-2.69-.01l-.11-.1C5.3 15.27 1.87 12.16 2 8.28c.06-1.7.93-3.33 2.34-4.29 2.64-1.8 5.9-.96 7.66 1.1 1.76-2.06 5.02-2.91 7.66-1.1 1.41.96 2.28 2.59 2.34 4.29.14 3.88-3.3 6.99-8.55 11.76l-.1.09z"></path></svg> {{fav_count}}</li>
						<?php if( $music->config->artist_sell == 'on' && $music->songData->price > 0){ ?>
							<li><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a6 6 0 0 1 6 6v1h4v2h-1.167l-.757 9.083a1 1 0 0 1-.996.917H4.92a1 1 0 0 1-.996-.917L3.166 11H2V9h4V8a6 6 0 0 1 6-6zm1 11h-2v4h2v-4zm-4 0H7v4h2v-4zm8 0h-2v4h2v-4zm-5-9a4 4 0 0 0-3.995 3.8L8 8v1h8V8a4 4 0 0 0-3.8-3.995L12 4z"></path></svg> {{purchase_count}}</li>
						<?php } ?>
					</ul>
				</div>
				<div class="sfy_plist_info">
					<div class="ds_review_headlines"><?php
											if ( getReviewsCount($music->songData->id) > 0 ){
												echo '<a href="{{LINK track-reviews/{{t_audio_id}}}}" data-load="track-reviews/{{t_audio_id}}">';
												for($i = 1; $i <= (int)$music->rate_avg ; $i++){
													echo '';
												}
												echo $music->total_review . ' ' . lang('Reviews');
												echo '</a>';
											}
										?><?php echo getTrackReviewButton(['user_id' => $music->user->id,'track_id' => $data['t_id']]); ?></div>
					<span class="al_artist dropdown">
						<a href="javascript:void(0);" data-display="static" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{USER name}}</a>
						<ul class="dropdown-menu">
							<div class="sfy_song_pblshr">
								<div class="avatar">
									<a href="{{USER url}}" data-load="{{USER username}}"><img src="{{USER avatar}}" alt="User Avatar"></a>
								</div>
								<h4><a href="{{USER url}}" data-load="{{USER username}}">{{USER name}}</a> <?php if ($music->config->go_pro == 'on') { ?><?php if ($music->songData->publisher->is_pro == 1) { ?><span title="{{LANG PRO Memeber}}">PRO</span><?php } ?><?php } ?></h4>
								<p>{{COUNT_USER_FOLLOWERS}} {{LANG Followers}}</p>
								<p>{{COUNT_USER_SONGS}} {{LANG Tracks}}</p>
								<?php if ($music->songData->owner == false && IS_LOGGED) {?>
								<?php if (!isFollowing($music->songData->publisher->id)) { ?>
									<button class="btn btn-primary btn-mat btn-mat-raised" id="follow-user" data-user-id="{{USER id}}">{{LANG Follow}}</button>
								<?php } else { ?>
									<button class="btn btn-success btn-mat btn-mat-raised" id="unfollow-user" data-user-id="{{USER id}}">{{LANG Following}}</button>
							    <?php } ?>
								<?php } ?>
							</div>
						</ul>
					</span>
					<span>â€¢</span>
					<span class="al_artist">{{LANG Published}} <span class="ajax-time" title="{{ts_time}}">{{t_time}}</span> {{LANG in}} <a href="{{LINK explore-genres/<?php echo $music->songData->category_id;?>}}" data-load="explore-genres/<?php echo $music->songData->category_id;?>">{{category_name}}</a><?php if (!empty($music->albumData)) { ?>, {{LANG in album:}} <a href="{{LINK album/<?php echo $music->albumData->album_id;?>}}" data-load="album/<?php echo $music->albumData->album_id;?>"><?php echo $music->albumData->title;?></a><?php } ?></span>
					<h2 class="al_name">{{t_title}}</h2>
					<p class="sfy_song_desc">{{t_description}}</p>
					<div class="sfy_song_tags">
						<?php foreach ($music->songData->tagsFiltered as $key => $tag) { ?>
							<a href="{{LINK search/songs/}}<?php echo $tag?>" data-load='search/songs/<?php echo $tag?>'>#<?php echo $tag?></a>
						<?php } ?>
					</div>
					<div class="valign ss_actions sfy_song_actns">
						<div class="valign ss_actions_innr">
							<?php echo getLikeButton($music->songData->id, 'like-default'); ?>
							<?php echo getDisLikeButton($music->songData->id, 'dislike-default'); ?>
							<?php if (IS_LOGGED) { ?>
								<button class="ss_action_item" onclick="rePost('{{t_id}}', $(this));"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M4 19h16v-5h2v6a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-6h2v5zm8-9H9a5.992 5.992 0 0 0-4.854 2.473A8.003 8.003 0 0 1 12 6V2l8 6-8 6v-4z"></path></svg> {{LANG Re Post}}</button>
							<?php } ?>
							<button class="ss_action_item" onclick="getShareModal('{{t_id}}', $(this));"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M10 3v2H5v14h14v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h6zm7.707 4.707L12 13.414 10.586 12l5.707-5.707L13 3h8v8l-3.293-3.293z"></path></svg> {{LANG Share}}</button>
							<?php if ($music->can_download == true && $music->songData->allow_downloads == 1) { ?>
								<a class="ss_action_item" href="{{LINK download.php?id={{t_audio_id}}}}" download><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20"><path fill="currentColor" d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"></path></svg> {{LANG Download}}</a>
							<?php } ?>
							<?php if($music->config->artist_sell == 'on'){ ?>
								<?php if ($music->isPurchased == false && $music->songData->owner == false && $music->songData->price > 0) { ?>
									<button class="ss_action_item btn-success" onclick="purchaseTrack('{{t_audio_id}}', $(this),'buy_song','{{t_price}}')" data-title="{{t_title}}" data-price="{{t_price}}" title="{{LANG Purchase}}">{{CONFIG currency_symbol}}{{t_price}}</button>
								<?php } ?>
							<?php } ?>
							<span class="dropdown">
								<div class="ss_action_item" data-display="static" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z" /></svg> {{LANG More}}</div>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="javascript:void(0)" onclick="getPlayLists({{t_id}})">{{LANG Add to Playlist}}</a></li>
									<?php if ($music->songData->owner == true || IsAdmin()) { ?>
										<li><a href="{{LINK edit-track/{{t_audio_id}}}}" data-load="edit-track/{{t_audio_id}}">{{LANG Edit Info}}</a></li>
										<?php if ($music->songData->owner == true && $music->songData->album_id == 0) { ?>
											<li><a href="javascript:void(0)" onclick="moveToAlbum(<?php echo $data['t_id'];?>)">{{LANG Move to album}}</a></li>
										<?php } ?>
										<li><a href="javascript:void(0)" onclick="$('#delete-song').attr('data-id', '{{t_id}}')" data-toggle="modal" data-target="#delete-song">{{LANG Delete Track}}</a></li>
									<?php } else if (IS_LOGGED == true) { ?>
										<li><?php echo getTrackReportButton(['user_id' => $music->user->id,'track_id' => $data['t_id']]); ?></li>
										<li><a href="javascript:void(0)" onclick="$('#song-copyright-id').val('{{t_id}}');"  data-toggle="modal" data-target="#create_copyright_box">{{LANG Report Copyright}}</a></li>
									<?php } ?>
									<?php if ($music->songData->owner == true || IsAdmin()) { ?>
										<li><a href="{{LINK track-statistics/{{t_audio_id}}/today}}" data-load="track-statistics/{{t_audio_id}}/today">{{LANG Statistics}}</a></li>
									<?php } ?>
								</ul>
							</span>
						</div>
					</div>
				</div>
			</div>
			<div class="valign sfy_song_btmprt">
				<div class="ss_track_play_pause">
					<div class="btn btn-primary btn-mat btn-mat-raised play_btn" onclick="<?php if (empty($music->songData->dark_wave) && empty($music->songData->light_wave)) { ?>wavesurfer.play();<?php } else { ?>playSong('{{t_audio_id}}');<?php } ?>"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path fill="currentColor" d="M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z"></path></svg></div>
					<div class="btn btn-primary btn-mat btn-mat-raised pause_btn" onclick="<?php if (empty($music->songData->dark_wave) && empty($music->songData->light_wave)) { ?>wavesurfer.pause();<?php } else { ?>Amplitude.pause();<?php } ?>$('body').removeClass('player_running');"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path fill="currentColor" d="M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2zm6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2z"></path></svg></div>
					<span>{{COUNT_VIEWS}}</span>
				</div>
				<div>
					<div id="waveform-load"></div>
					<?php
						$dark = $music->songData->dark_wave;
						$light = $music->songData->light_wave;
						$bar = '#363636';
						$opacity = '';

						if( $music->config->ffmpeg_system == 'off'){
							$dark = $music->songData->light_wave;
							$light = $music->songData->dark_wave;

							if($_COOKIE['mode'] == 'day'){
								$bar = 'rgb(191, 191, 191)';
								$opacity = 'opacity: 0.5;';
								if($music->songData->ffmpeg == 0){
									$dark = $music->songData->light_wave;
									$light = $music->songData->dark_wave;
								}else{
									$dark = $music->songData->dark_wave;
									$light = $music->songData->light_wave;
								}
							}else{
								$opacity = '';
								if($music->songData->ffmpeg == 0){
									$dark = $music->songData->light_wave;
									$light = $music->songData->dark_wave;
								}else{
									$dark = $music->songData->dark_wave;
									$light = $music->songData->light_wave;
								}
							}
						}else{
							$dark = $music->songData->dark_wave;
							$light = $music->songData->light_wave;

							if($_COOKIE['mode'] == 'day'){
								$dark = str_replace('_dark.png','_day.png',$music->songData->dark_wave);
								if(!file_exists( $dark ) && ($music->config->s3_upload != 'on' && $music->config->ftp_upload != "on" && $music->config->spaces !=  "on" && $music->config->google_drive !=  "on" && $music->config->wasabi_storage !=  'on' && $music->config->backblaze_storage !=  'on')){
									$dark = $music->songData->light_wave;
									$light = $music->songData->dark_wave;
								}
								$bar = 'rgb(191, 191, 191)';
							}else{
								$dark = str_replace('_day.png','_dark.png',$music->songData->dark_wave);

								if($music->songData->ffmpeg == 0){
									$dark = $music->songData->light_wave;
									$light = $music->songData->dark_wave;
								}else{
									$dark = $music->songData->dark_wave;
									$light = $music->songData->light_wave;
								}
							}
						}
					$rl = 'left: 0;border-left: inherit!important;border-right: 1px solid '.$bar.' !important;';
					if ( $music->language_type == 'rtl' ){
						$rl = 'right: 0;border-#delete-songright: inherit!important;border-left: 1px solid '.$bar.' !important;';
					}
					?>
					<div id="waveform" class="sfy_waveforms">
						<div class="images" id="dark-waves">
							<img src="<?php echo getMedia($dark); ?>" style="width: 100%;<?php echo $opacity;?>" id="dark-wave">
							<div style="width: 0%; z-index: 111; position: absolute; overflow: hidden; top: 0; <?php echo $rl;?> " id="light-wave">
								<img src="<?php echo getMedia($light); ?>">
							</div>
						</div>
						<div class="comment-waves">
							{{comments_on_wave}}
						</div>
					</div>
				</div>
			</div>
		</div>
        <div class="single_song">
            <input type="hidden" id="current-track" value="{{t_audio_id}}">
            <div class="container">
                <div class="row">
					<div class="col-lg-1"></div>
                    <div class="col-lg-10">
                        <div class="content">
							<div class="valign sfy_pg_title">
								<h4 class="valign ptitle">{{total_review}} {{LANG Reviews}}</h4>
								<div class="rat_avg_strs">
									<?php
                                    for($i = 1; $i <= (int)$music->rate_avg ; $i++){
                                    echo '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#ff9900" d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"></path></svg>';
                                    }
                                    ?>
                                    <?php
										echo number_format($music->rate_avg, 2);
                                    ?>
								</div>
							</div>
                            <div class="ds_track_reviews">
								{{reviews_html}}
                            </div>
                        </div>
                    </div>
					<div class="col-lg-1"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<img src="" alt="" id="de-image">

<script src="{{theme_url}}/js/jquery.adaptive-backgrounds.js"></script>
<script>
$(document).ready(function(){
	var defaults = {
		selector: '[data-adaptive-background="1"]',
		parent: '#sfy_hdr_rgb',
	};
	$.adaptiveBackground.run(defaults)
});

    jQuery(document).ready(function($) {
    <?php if ($music->autoPlay == true) { ?>
            playSong($('#current-track').val());
        <?php } ?>
        $('#light-wave img').width($('#dark-wave').width() + 'px');
    });
    <?php if (empty($music->songData->dark_wave) && empty($music->songData->light_wave)) { ?>
        var wavesurfer = WaveSurfer.create({
            container: '#waveform',
            waveColor: '<?php echo $music->config->waves_color;?>',
            progressColor: '#bfbfbf',
            height: 150,
            scrollParent: false,
            responsive: true,
        });

        wavesurfer.on('loading', function (integer) {
            $('#waveform-load').html("{{LANG Generating waves..}} (" + integer + '%)');
        });

        wavesurfer.on('ready', function (percents) {
            $('body').addClass('waveform_ready');
            wavesurfer.setVolume(0);
            setTimeout(function () {
                $.post('{{CONFIG ajax_url}}/convert-waves', {darkImage: wavesurfer.exportImage(), LightImage: convertCanvasToImage(), id: "{{t_audio_id}}"}, function (data) {
                    if (data.status == 200) {
                        location.reload();
                    }
                });
            }, 300);
            $('#waveform-load').empty();
        });
        wavesurfer.on('play', function (percents) {
            $('body').addClass('waveform_ready');
            $('body').addClass('player_running');
            setTimeout(function () {
                convertCanvasToImage
            } , 5000);

            Amplitude.play();
        });
        wavesurfer.on('pause', function (percents) {
            $('body').removeClass('player_running');
            Amplitude.pause()
        });

        wavesurfer.on('seek', function (seeks) {
            Amplitude.skipTo( wavesurfer.getCurrentTime(), 0 )
            wavesurfer.setVolume(0);
        });
        wavesurfer.load('{{t_song}}');
    <?php } ?>

    function convertCanvasToImage() {
        var can = $('canvas').get(0);
        return can.toDataURL();
    }
</script>

<script>
    if( typeof $('#rmjs-1').readmore !== "undefined" ) {
        $('#rmjs-1').readmore({
            speed: 75,
            collapsedHeight: 190,
            moreLink: '<a href="#" class="hash"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z" /></svg> {{LANG Read more}}</a>',
            lessLink: '<a href="#" class="hash"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z" /></svg> {{LANG Read less}}</a>',
            afterToggle: function (trigger, element, expanded) {
                //if(! expanded) {
                // The "Close" link was clicked
                $('html, body').animate({scrollTop: element.offset().top}, {duration: 100});
                //}
            }
        });
    }
</script>
